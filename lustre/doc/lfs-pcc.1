.TH LFS-PCC 1 2019-04-15 "Lustre" "Lustre Utilities"
.SH NAME
lfs pcc commands used to interact with PCC features.
.SH SYNOPSIS
.B lfs pcc attach <\fB--id\fR|\fB-i\fR NUM>  <\fIfile \fR...>
.br
.B lfs pcc detach <\fIfile \fR...>
.br
.B lfs pcc detach_fid <\fImntpath\fR> <\fIfid \fR...>
.br
.B lfs pcc state <\fIfile \fR...>
.SH DESCRIPTION
.TP
.B lfs pcc attach <\fB--id\fR|\fB-i\fR NUM>  <\fIfile \fR...>
Attach given files on the persistent client cache.
.TP
.B lfs pcc detach <\fIfile \fR...>
Detach given files from the persistent client cache.
.TP
.B lfs pcc detach_fid <\fImntpath\fR> <\fIfid \fR...>
Detach files from the persistent client cache by FID(s).
.TP
.B lfs pcc state <\fIfile \fR...>
Display the PCC state for given files.
.TP
.SH OPTIONS
.TP
.B --id | -i
For RW-PCC, it is HSM ARCHIVE ID to choose which backend for cache files.
.TP
Before using RW-PCC, you need to configure HSM root and Archive ID mapping properly:
.TP
.B lfs pcc add $MNTPATH $PCCPATH "$ARCHIVE_ID $PROJID"
Add one PCC backend to the Lustre client, you need to specify hsm root,
archive ID, and project ID. On this client any subsequently created
files with this project ID will be persistently cached automatically.
.TP
.B lfs pcc del $MNTPATH $PCCPATH
 Delete one PCC backend
.TP
.B lfs pcc clear $MNTPATH
 Clear and remove all PCC backends for the client.
.TP
.SH EXAMPLES
.TP
.B # lctl set_param mdt.$FSNAME-MDT0000.hsm_control=enabled
Enable HSM on the appropriate MDT.
.TP
.B # lhsmtool_posix --daemon --hsm-root /mnt/pcc/ --archive=1 /mnt/lustre
Launch one copytool on client node to connect cache storage.
.TP
.B # lfs pcc add /mnt/lustre /mnt/pcc \ "1\ 1"
Add HSM root and Archive ID mapping for RW-PCC.
.TP
.B $ lfs pcc attach -i 1 /mnt/lustre/file
Attach an existing file into PCC and migrate data from lustre to Cache Device,
any I/O to the Lustre file will direct to the RW-PCC copy.
.TP
.B $ lfs pcc detach /mnt/lustre/file
Detach the file from RW-PCC, IO to the file will come to Lustre after this command.
.TP
.B $ lfs pcc state /mnt/lustre/file
.br
file: /mnt/lustre/file, type: readwrite, PCC file: /mnt/pcc/0004/0000/0bd1/0000/0002/0000/0x200000bd1:0x4:0x0, user number: 1, flags: 6
.br
Display the PCC state of the file "/mnt/lustre/file".
.TP
.SH SEE ALSO
.BR lfs (1),
.BR lfs-hsm (1),
.BR lctl-pcc (8)
