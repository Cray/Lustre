Index: linux-4.12.14-16.4.1/fs/ext4/ext4.h
===================================================================
--- linux-4.12.14-16.4.1.orig/fs/ext4/ext4.h
+++ linux-4.12.14-16.4.1/fs/ext4/ext4.h
@@ -695,6 +695,20 @@ struct fsxattr {
 #define EXT4_GOING_FLAGS_LOGFLUSH		0x1	/* flush log but not data */
 #define EXT4_GOING_FLAGS_NOLOGFLUSH		0x2	/* don't flush log nor data */
 
+#define current_time(a) ext4_current_time(a)
+static inline struct timespec ext4_current_time(struct inode *inode)
+{
+	struct timespec now = current_kernel_time();
+
+	if (IS_NOCMTIME(inode))
+		return inode->i_ctime;
+
+	/* Copy from fs/inode.c */
+	if (unlikely(!inode->i_sb))
+		return now;
+
+	return timespec_trunc(now, inode->i_sb->s_time_gran);
+}
 
 #if defined(__KERNEL__) && defined(CONFIG_COMPAT)
 /*
