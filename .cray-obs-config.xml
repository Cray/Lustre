<?xml version="1.0" ?>
<configuration xmlns="http://svndownstream.us.cray.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <stream type="obs" xsi:type="obsStreamType">
        <project>
            cray-lustre:
            <extracted refer="full-branch"/>
        </project>
        <sources>
            <environment>
                <variable>
                    RELEASE_EXTRA
                </variable>
                <name>
                    _release_extra
                </name>
            </environment>
            <gitcmd>
                <command>
                    branch | sed -e 's/(HEAD detached at //' -e 's/)//'
                </command>
                <name>
                    _branch
                </name>
                <extract group="1" name="full-branch" pattern="\*\s+(.*$)"/>
            </gitcmd>
            <gitcmd>
                <command>
                    rev-parse --short
                    <extracted refer="full-branch"/>
                </command>
                <name>
                    _last_changed_rev
                </name>
            </gitcmd>
            <gitcmd>
                <command>
                    config --get remote.origin.url
                </command>
                <name>
                    _url
                </name>
            </gitcmd>
            <gitcmd>
                <command>
                    describe --first-parent --tags --match='*_cray' --dirty=_$USER | sed -e 's/-/./g' -e 's/_cray//'
                </command>
                <name>
                    _tag
                </name>
            </gitcmd>
            <gitcmd>
                <command>
                    describe --first-parent --tags --match='*_cray' | sed -e 's/-/./' -e 's/-g.*//' -e 's/_cray//'
                </command>
                <name>
                    _version
                </name>
                <extract group="1" name="version" pattern="(.*)"/>
            </gitcmd>
            <file>
                <name>
                    ccs-lustre-apollo.spec
                </name>
            </file>
            <file>
                <name>
                    ccs-lustre-apollo_s.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-gem_c.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-ari_s.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-ari_s-rhine.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-ari_c-rhine.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-ari_c.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-rpmlintrc
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-ari_s-cos.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lnet-devel.spec
                </name>
                <extract group="1" name="branch" pattern="^%define\s+branch\s+(\S+)"/>
            </file>
            <file>
                <name>
                    cray-lustre-gem_s-cos.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-gem_s.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-lnet-ari_s-rhine.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-lnet-ari_s.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-lnet-gem_s.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-lnet-ari_c.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-lnet-gem_c.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-pinehurst.spec
                </name>
            </file>
            <file>
                <name>
                    ccs-lustre-apollo.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-dmp_c.spec
                </name>
            </file>
            <file>
                <name>
                    cray-lustre-dmp_s.spec
                </name>
            </file>
            <file>
                <name>
                  devel/cray-lustre-api-devel.pc
                </name>
            </file>
            <file>
                <name>
                  devel/cray-lustre-cfsutil-devel.pc
                </name>
            </file>
            <file>
                <name>
                  devel/cray-lustre-ptlctl-devel.pc
                </name>
            </file>
            <file>
                <name>
                  devel/cray-lustre.conf
                </name>
            </file>
            <tarfile compression="bz2">
                <name>
                    cray-lustre-
                    <extracted refer="version"/>
                </name>
                <exclusion pattern=".*\.spec$"/>
                <exclusion pattern="^Makefile\.obs$"/>
                <tarinfo recursive="true">
                    <name>
                        .
                    </name>
                    <arcname>
                        cray-lustre-
                        <extracted refer="version"/>
                    </arcname>
                </tarinfo>
            </tarfile>
            <tarfile compression="bz2">
                <name>
                    cray-lnet-devel-
                    <extracted refer="version"/>
                </name>
                <tarinfo>
                    <name>
                        devel
                    </name>
                    <arcname>
                        cray-lnet-devel-
                        <extracted refer="version"/>
                    </arcname>
                </tarinfo>
            </tarfile>
            <tarfile compression="bz2">
                <name>
                    cray-lustre-switch-
                    <extracted refer="version"/>
                </name>
                <tarinfo>
                    <name>
                        switch
                    </name>
                    <arcname>
                        cray-lustre-switch-
                        <extracted refer="version"/>
                    </arcname>
                </tarinfo>
            </tarfile>
        </sources>
        <package>
            cray-lustre
        </package>
    </stream>
</configuration>
